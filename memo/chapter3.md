# chapter3

## 演算子

演算子とは、与えられた値を使って計算を行うための記号です。演算子には、算術演算子、比較演算子、論理演算子、ビット演算子、代入演算子、その他の演算子があります。

### 算術演算子

算術演算子は、数値を使って計算を行うための演算子です。算術演算子には、加算演算子（+）、減算演算子（-）、乗算演算子（\*）、除算演算子（/）、剰余演算子（%）があります。

### 加算演算子（+）

加算演算子（+）は、左辺と右辺の値を加算して、その結果を返す演算子です。

```js
console.log(1 + 2); // 3
console.log("1" + "2"); // "12"
console.log(1 + "2" + 3); // "123"
console.log(1 + 2 + "3"); // "33"
```

### インクリメント演算子（++）とデクリメント演算子（--）

```js
const x = 1;
const y = 3;
console.log(x++); // 2
console.log(++x); // 2
console.log(y--); // 2
console.log(--y); // 2
```

ただし、注意点として、インクリメント演算子（++）とデクリメント演算子（--）は、前置演算子と後置演算子の 2 つの使い方があります。前置演算子は、演算子が変数の前にある場合に、変数の値を変更してから式を評価します。後置演算子は、演算子が変数の後にある場合に、式を評価してから変数の値を変更します。

```js
let x = 1;
let y = ++x;
console.log(x); // 1
console.log(y); // 2
x = 1;
y = x++;
console.log(x); // 2
console.log(y); // 1
```

小数点を含む演算を行う場合、誤差が生じることがあります。これは、コンピュータが 2 進数で数値を表現するために生じる問題です。

この問題を解決するために、小数点を含む演算を行う際には、誤差が生じないように注意する必要があります。

そのため、基本的には、小数点を含む演算を行う際には、整数に変換してから演算を行うことが望ましいです。

ちなみに、`decimal.js` ライブラリを使うことで、小数点を含む演算を行う際に誤差を解消することができます。

### 代入演算子

指定された変数に値を代入するための演算子です。代入演算子には、等価演算子（=）、加算代入演算子（+=）、減算代入演算子（-=）、乗算代入演算子（\*=）、除算代入演算子（/=）、剰余代入演算子（%=）があります。

| 演算子 | 説明                    | 例        |
| ------ | ----------------------- | --------- |
| =      | 等価演算子              | x = 1     |
| +=     | 加算代入演算子          | x += 1    |
| -=     | 減算代入演算子          | x -= 1    |
| \*=    | 乗算代入演算子          | x \*= 1   |
| /=     | 除算代入演算子          | x /= 1    |
| %=     | 剰余代入演算子          | x %= 1    |
| \*\*=  | 累乗代入演算子          | x \*\*= 1 |
| <<=    | 左シフト代入演算子      | x <<= 1   |
| >>=    | 右シフト代入演算子      | x >>= 1   |
| &=     | ビット AND 代入演算子   | x &= 1    |
| \|=    | ビット OR 代入演算子    | x \|= 1   |
| ^=     | ビット XOR 代入演算子   | x ^= 1    |
| &&=    | ロジカル AND 代入演算子 | x &&= 1   |
| \|\|=  | ロジカル OR 代入演算子  | x \|\|= 1 |

### = 演算子

その要素が、「基本」か「オブジェクト」かによって、代入の挙動が異なります。

ちなみに、定数には再代入できないため、定数に対して再代入を行うとエラーが発生します。

```js
// 基本
let x = 1;
let y = x;
x = 2;
console.log(x); // 2
console.log(y); // 1

// オブジェクト
let data1 = [1, 2, 3];
let data2 = data1;
data1[0] = 4;
console.log(data1); // [4, 2, 3]
console.log(data2); // [4, 2, 3]

// オブジェクト2
let data3 = [1, 2, 3];
let data4 = data3;
data3 = [4, 5, 6];
console.log(data3); // [4, 5, 6]
console.log(data4); // [1, 2, 3]
```

### 分割代入

分割代入は、配列やオブジェクトの要素を分割して、それぞれの変数に代入するための構文です。

```js
// 配列
const data = [1, 2, 3];
const [a, b, c] = data;
console.log(a); // 1
console.log(b); // 2
```

配列と変数の数が一致しない場合、残りの要素は配列として代入されます。

```js
const data = [1, 2, 3];
const [a, b] = data;
console.log(a); // 1
console.log(b); // 2
console.log(data); // [3]
```

「...」を使うことで、残りの要素を配列として取得することができます。

```js
const data = [1, 2, 3];
const [a, ...b] = data;
console.log(a); // 1
console.log(b); // [2, 3]
```

要素の入れ替えを行うこともできます。（スワッピング）

```js
let a = 1;
let b = 2;
[a, b] = [b, a];
console.log(a); // 2
console.log(b); // 1
```

### 分割代入（オブジェクト）

オブジェクトの場合も、同様に分割代入を行うことができます。

```js
let data = { x: 1, y: 2, z: 3 };
let { x, y, n = 4 } = data;
console.log(x); // 1
console.log(y); // 2
console.log(n); // 4
```

上記の `n = 4` は、デフォルト値を指定しています。

また、より複雑なオブジェクトの場合、「ネストされたオブジェクトの分解」・「変数名の変更」・「『...』を使った残りのプロパティの取得」・「宣言と分離した分割代入」などが可能です。

### 比較演算子

左辺 / 右辺の値を比較して、その結果を返す演算子です。比較演算子には、等価演算子（==）、厳密等価演算子（===）、不等価演算子（!=）、厳密不等価演算子（!==）、大なり演算子（>）、大なりイコール演算子（>=）、小なり演算子（<）、小なりイコール演算子（<=）があります。

| 演算子 | 説明 | 例 |
| --- | --- | --- |
| == | 等価演算子 | 5 == 5 // true |
| === | 厳密等価演算子 | 5 === 5 // true |
| != | 不等価演算子 | 5 != 5 // false |
| !== | 厳密不等価演算子 | 5 !== 5 // false |
| > | 大なり演算子 | 5 > 5 // false |
| >= | 大なりイコール演算子 | 5 >= 5 // true |
| < | 小なり演算子 | 5 < 5 // false |
| <= | 小なりイコール演算子 | 5 <= 5 // true |
| ?: | 条件演算子 | 5 > 5 ? "true" : "false" // false |
| ?? | null 合体演算子（null でなければ、その値が表示される） | null ?? "default" // "default" |

### 論理演算子

論理演算子は、論理値を使って計算を行うための演算子です。論理演算子には、論理積演算子（&&）、論理和演算子（||）、否定演算子（!）があります。

| 演算子 | 説明         | 例                      |
| ------ | ------------ | ----------------------- |
| &&     | 論理積演算子 | true && true // true    |
| \|\|   | 論理和演算子 | true \|\| false // true |
| !      | 否定演算子   | !true // false          |

ショートカット演算（短絡評価）を利用することで、処理を効率的に行うことができます。

```js
const data = null;
const result = data && data.value;
console.log(result); // null
```

### ビット演算子

ビット演算子は、ビット単位で計算を行うための演算子です。ビット演算子には、ビット AND 演算子（&）、ビット OR 演算子（\|）、ビット XOR 演算子（^）、ビット NOT 演算子（~）、左シフト演算子（<<）、右シフト演算子（>>）、ゼロ埋め右シフト演算子（>>>）があります。

| 演算子 | 説明                   | 例           |
| ------ | ---------------------- | ------------ |
| &      | ビット AND 演算子      | 5 & 3 // 1   |
| \|     | ビット OR 演算子       | 5 \| 3 // 7  |
| ^      | ビット XOR 演算子      | 5 ^ 3 // 6   |
| ~      | ビット NOT 演算子      | ~5 // -6     |
| <<     | 左シフト演算子         | 5 << 1 // 10 |
| >>     | 右シフト演算子         | 5 >> 1 // 2  |
| >>>    | ゼロ埋め右シフト演算子 | 5 >>> 1 // 2 |
| &      | ビット AND 演算子      | 5 & 3 // 1   |

### その他の演算子

これまでに紹介した演算子以外にも、その他の演算子があります。その他の演算子には、三項演算子（?:）、null 合体演算子（??）、typeof 演算子（typeof）、インスタンス演算子（instanceof）、剰余演算子（%）があります。

| 演算子     | 説明                                       | 例                                |
| ---------- | ------------------------------------------ | --------------------------------- |
| ?:         | 三項演算子                                 | 5 > 5 ? "true" : "false" // false |
| ??         | null 合体演算子                            | null ?? "default" // "default"    |
| typeof     | typeof 演算子                              | typeof 5 // "number"              |
| instanceof | インスタンス演算子                         | data instanceof Array // true     |
| %          | 剰余演算子                                 | 5 % 3 // 2                        |
| new        | new 演算子（新しいインスタンスを生成する） | new Array(1, 2, 3)                |
| void       | void 演算子（undefined を返す）            | void 0                            |
| ,(カンマ)  | 左右の指揮を続けて実行する                 | 1, 2, 3                           |
| delete     | オブジェクトのプロパティを削除する         | delete data.value                 |

### 演算子の優先順位

優先度が高い順に、以下のようになります。

- グループ演算子（()）
- 配列([])
- new
- 後置演算子（x++、x--）
- 前置演算子（++x、--x、+x、-x、!x、~x、typeof、void）
- べき乗（**）
- 乗算(*)、除算(/)、剰余(%)
- 加算(+)、減算(-)
- シフト演算子(<<、>>、>>>)
- 比較演算子(<、>、<=、>=、instanceof、in)
- 等価演算子(==、!=、===、!==)
- ビット AND(&)
- ビット XOR(^)
- ビット OR(|)
- 論理 AND(&&)
- 論理 OR(||)
- NULL 合体演算子(??)
- 条件演算子(?:)
- 代入(=、+=、-=、\*=、/=、%=、**=、<<=、>>=、>>>=、&=、^=、\|=)
- yield
- カンマ(,)
